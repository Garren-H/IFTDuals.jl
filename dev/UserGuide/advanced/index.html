<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Usage · IFTDuals.jl</title><meta name="title" content="Advanced Usage · IFTDuals.jl"/><meta property="og:title" content="Advanced Usage · IFTDuals.jl"/><meta property="twitter:title" content="Advanced Usage · IFTDuals.jl"/><meta name="description" content="Documentation for IFTDuals.jl."/><meta property="og:description" content="Documentation for IFTDuals.jl."/><meta property="twitter:description" content="Documentation for IFTDuals.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IFTDuals.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">User Documentation</span><ul><li><a class="tocitem" href="../limitations/">Limitations</a></li><li><a class="tocitem" href="../api/">API Reference</a></li><li class="is-active"><a class="tocitem" href>Advanced Usage</a><ul class="internal"><li><a class="tocitem" href="#Keyword-Arguments"><span>Keyword Arguments</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../dev/">Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Documentation</a></li><li class="is-active"><a href>Advanced Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced Usage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Garren-H/IFTDuals.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Garren-H/IFTDuals.jl/blob/master/docs/src/UserGuide/advanced.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-Usage"><a class="docs-heading-anchor" href="#Advanced-Usage">Advanced Usage</a><a id="Advanced-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Usage" title="Permalink"></a></h1><p>The <code>ift</code> function accepts several keyword arguments that can improve performance by providing additional information about your differentiation setup. By default, these parameters are auto-detected, but specifying them explicitly can avoid redundant computations.</p><h2 id="Keyword-Arguments"><a class="docs-heading-anchor" href="#Keyword-Arguments">Keyword Arguments</a><a id="Keyword-Arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Keyword-Arguments" title="Permalink"></a></h2><pre><code class="language-julia hljs">ift(y, f, args; DT=nothing, tag_is_mixed=nothing, args_needs_promotion=true)
ift(y, f, args, args_primal; DT=nothing, tag_is_mixed=nothing, args_needs_promotion=true)</code></pre><h3 id="args_primal-Primal-value-of-args-(positional-argument)"><a class="docs-heading-anchor" href="#args_primal-Primal-value-of-args-(positional-argument)"><code>args_primal</code> - Primal value of args (positional argument)</a><a id="args_primal-Primal-value-of-args-(positional-argument)-1"></a><a class="docs-heading-anchor-permalink" href="#args_primal-Primal-value-of-args-(positional-argument)" title="Permalink"></a></h3><p>The <code>ift</code> function can accept the primal value of <code>args</code> as a second positional argument. This is particularly useful because you typically need to compute <code>nested_pvalue(args)</code> to solve for the primal solution <code>y</code> anyway. By passing it to <code>ift</code>, you avoid recomputing it internally:</p><pre><code class="language-julia hljs">function solve_y(θ)
    θ_primal = nested_pvalue(θ)  # Compute once
    y = solve_for_y(θ_primal)     # Use to solve for y
    return ift(y, f, θ, θ_primal) # Pass to ift to avoid recomputation
end</code></pre><p><strong>Performance benefit</strong>: This eliminates the overhead of calling <code>nested_pvalue(args)</code> inside <code>ift</code>, which can be significant for complex nested structures.</p><h3 id="DT::Union{Nothing,Type{:Dual}}-Target-dual-type"><a class="docs-heading-anchor" href="#DT::Union{Nothing,Type{:Dual}}-Target-dual-type"><code>DT::Union{Nothing,Type{&lt;:Dual}}</code> - Target dual type</a><a id="DT::Union{Nothing,Type{:Dual}}-Target-dual-type-1"></a><a class="docs-heading-anchor-permalink" href="#DT::Union{Nothing,Type{:Dual}}-Target-dual-type" title="Permalink"></a></h3><p>By default, <code>ift</code> automatically detects the dual type from <code>args</code>. If you already know the target dual type, you can specify it to skip the type detection step. This is useful in cases where several variables are passed to <code>args</code> for which only one is of Dual type and the type is know.</p><h3 id="tag_is_mixed::Union{Nothing,Bool}-Whether-tags-are-mixed-(default:-nothing)"><a class="docs-heading-anchor" href="#tag_is_mixed::Union{Nothing,Bool}-Whether-tags-are-mixed-(default:-nothing)"><code>tag_is_mixed::Union{Nothing,Bool}</code> - Whether tags are mixed (default: <code>nothing</code>)</a><a id="tag_is_mixed::Union{Nothing,Bool}-Whether-tags-are-mixed-(default:-nothing)-1"></a><a class="docs-heading-anchor-permalink" href="#tag_is_mixed::Union{Nothing,Bool}-Whether-tags-are-mixed-(default:-nothing)" title="Permalink"></a></h3><p>This is only applicable when computing derivatives of order 2 or higher.</p><p>Two different implementations for IFT exists depending on the Dual structures/tags used in <code>args</code>. If all of the variables share the same Dual Tag, i.e. computing Hessians, second or higher order derivatives for a single variable (or vector/array of variables), the dual structure is symmetric. That is <code>value.partials</code> contains the same information as <code>partials.value</code>. In this case one can specify <code>tag_is_mixed=false</code> to effectively copy <code>value.partials</code> into <code>partials.value</code>, and hence avoid redundant computations. Important to note is depending on how AD is called, different Dual tags can still be created internally, even when differentiating wrt a single variable. There is no way of identifying in this case whether the tags are truly mixed, hence it is left to the user to ensure this is set correctly. When specifying <code>tag_is_mixed=false</code>, an internal check is only conducted on the number of partials per Dual layer, but this is not sufficient to guarantee symmetry. This functionality should hence be used with caution.</p><p>If the variables in <code>args</code> have different Duals Tags, i.e. having multiple variables to differentiate with respect to, the dual structure is not symmetric. A simple use case here is computing cross-derivatives, e.g. having a function <code>g(x1, x2)</code> and wanting to compute <code>d²g/dx1dx2</code>. In this case the <code>value.partials</code> and <code>partials.value</code> fields are assymetric and both needs to be computed seperately. In most cases this will be the default due to the mixed tag creation mentioned above. </p><h3 id="args_needs_promotion::Bool-Whether-args-need-promotion-to-common-dual-type-(default:-true)"><a class="docs-heading-anchor" href="#args_needs_promotion::Bool-Whether-args-need-promotion-to-common-dual-type-(default:-true)"><code>args_needs_promotion::Bool</code> - Whether args need promotion to common dual type (default: <code>true</code>)</a><a id="args_needs_promotion::Bool-Whether-args-need-promotion-to-common-dual-type-(default:-true)-1"></a><a class="docs-heading-anchor-permalink" href="#args_needs_promotion::Bool-Whether-args-need-promotion-to-common-dual-type-(default:-true)" title="Permalink"></a></h3><p>Internally, <code>pvalue</code> is used to extract the <code>value</code> field from dual numbers and hence build the Dual from the inner most Dual outwards. This requires that all dual numbers in <code>args</code> are of the same type. By default, <code>ift</code> will promote all Dual numbers (in all elements of an Array/tuple and/or fields and nested fields in structs) to type <code>DT</code>. If you have already ensured that all dual numbers in <code>args</code> are of the same type, you can set this parameter to <code>false</code> to skip the promotion step and improve performance. This functionality should be used with caution, as providing for instance dual numbers of different tags will to incorrect results or errors.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/">« API Reference</a><a class="docs-footer-nextpage" href="../../dev/">Developer Documentation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 14 February 2026 15:11">Saturday 14 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
