<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Developer Documentation · IFTDuals.jl</title><meta name="title" content="Developer Documentation · IFTDuals.jl"/><meta property="og:title" content="Developer Documentation · IFTDuals.jl"/><meta property="twitter:title" content="Developer Documentation · IFTDuals.jl"/><meta name="description" content="Documentation for IFTDuals.jl."/><meta property="og:description" content="Documentation for IFTDuals.jl."/><meta property="twitter:description" content="Documentation for IFTDuals.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">IFTDuals.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">User Documentation</span><ul><li><a class="tocitem" href="../UserGuide/limitations/">Limitations</a></li><li><a class="tocitem" href="../UserGuide/api/">API Reference</a></li><li><a class="tocitem" href="../UserGuide/advanced/">Advanced Usage</a></li></ul></li><li class="is-active"><a class="tocitem" href>Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Developer Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Developer Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Garren-H/IFTDuals.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Garren-H/IFTDuals.jl/blob/master/docs/src/dev.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-IFTDuals-work"><a class="docs-heading-anchor" href="#How-IFTDuals-work">How IFTDuals work</a><a id="How-IFTDuals-work-1"></a><a class="docs-heading-anchor-permalink" href="#How-IFTDuals-work" title="Permalink"></a></h1><p>As mentioned, the IFT gives a generic way in which one can compute higher-order derivatives of implicit functions.</p><p class="math-container">\[\frac{d^K x}{d \theta^K} = - \left( \frac{\partial f}{\partial x} \right)^{-1} B_K\]</p><p>Where <span>$B_K=\frac{d^{K} f}{d \theta^{K}} - \frac{\partial f}{\partial x} \frac{d^{K} x}{d \theta^{K}}$</span>. The core idea of IFTDuals.jl is using dual numbers (specifically ForwardDiff.jl) and starting from the inner most Dual, compute <span>$B_K$</span> using AD, solve for the derivative, convert the result back into a dual and repeat the process until all dual levels have been processed.</p><p>To achieve this, all that is required is to seed <code>x</code> appropriately at each level and <span>$B_K$</span> will be recovered as the partials field. That is, for the inner most dual (1st order derivative), <code>x</code> is seeded with zero (or just using the primal value), resulting in <span>$B_1$</span> being given as</p><p class="math-container">\[B_1 = \frac{\partial f}{\partial \theta}\]</p><p>Now we reconstruct the dual number for the first order derivative</p><pre><code class="language-julia hljs">x_dual1 = DT1(x, PT1((dx_dtheta,))) # DT1 -&gt; Dual Type for level 1, PT1 -&gt; Partial Type for level 1</code></pre><p>Now to obtain the second order derivative, we need to seed <code>x_dual1</code> appropriately. If the partials are symmetric, then we seed</p><pre><code class="language-julia hljs">x_dual2_star = DT2(x_dual1, PT2(ntuple(j -&gt; DT1(x_dual.partials[j]),length(x)))) # DT2 -&gt; Dual Type for level 2, PT2 -&gt; Partial Type for level 2</code></pre><p>The evaluation of <code>f</code> at <code>x_dual2_star</code> and the second order dual <code>args</code> will yield <span>$B_2$</span> as the <code>partials.partials</code> field (this can easily be proved by performing the Dual arithmetic). We can then solve for the second order derivative, reconstruct the dual and repeat the process for higher order derivatives. Note that for symmetry of higher partials, we need to seed all partials.value fields with the correct derivatives computed. I.e. for a third order dual, we would need to seed the <code>partials.value.value</code> field with the first order derivatives computed, the <code>partials.partials.value</code> field with the second order derivatives computed and finally compute <span>$B_3$</span>, extract this as the <code>partials.partials.partials</code> field, solve the system and reconstruct the third order dual. This process is implemented recursively. The source code can be found <a href="https://github.com/Garren-H/IFTDuals.jl/blob/d92256a0b17b50ce34d4b540cd9e0823930b090f/src/derivatives.jl#L159">here</a>. </p><p>When we do not have symmetry of partials, we are still able to recover the correct <span>$B_K$</span> terms, but involves a bit more bookeeping. If we have two parameters, <code>θ₁</code> and <code>θ₂</code>, then for the second order dual, where <code>θ₁</code> is the inner dual and <code>θ₂</code> the outer dual. The first step would be convert <code>θ₁</code> and <code>θ₂</code> into duals of the same type, i.e. both second order duals where the inner dual has zero partials for <code>θ₂</code> and the outer dual has zero partials for <code>θ₁</code>. This is easily achieved with <code>Base.promote</code>. The first order dual is then extracted and the above mentioned procedure is followed to obtain <code>dx/dθ₁</code>. To obtain <code>dx/dθ₂</code>, we only need to evaluate <code>f</code> at the second order dual (irrespective of whether <code>x</code> is seeded with <code>dx/dθ₁</code> or zero) and extract the <code>partials.value</code> field to obtain <span>$B_1$</span> for <code>θ₂</code>. Following the Dual arithmetic one will note that the <code>value.partials</code> and <code>partials.value</code> fields are independent of each other. Once both <code>dx/dθ₁</code> and <code>dx/dθ₂</code> have been computed, we can reconstruct the second order dual with the correct partials, with zeroed <code>partials.partials</code> field. </p><pre><code class="nohighlight hljs">x_dual2_star = DT2(DT1(x,PT1((dx_dtheta1,))),PT2((DT1(dx_dtheta2),)))</code></pre><p>Now <span>$B_2$</span> can be obtained by evaluating <code>f</code> at <code>x_dual2_star</code> and the second order dual <code>args</code>, with <span>$B_2$</span> being extracted as the <code>partials.partials</code> field. <code>d²x/dθ₁dθ₂</code> is then solved for and the second order dual is reconstructed with the correct partials field. For third order duals the same process is followed, fist the <code>partials.value.value</code> and <code>partials.value.partials</code> fields are obtained, followed by the <code>partials.partials.value</code> field and finally <span>$B_3$</span> is obtained from the <code>partials.partials.partials</code> field. This process naturally has a recursive structure where two branches of recursion are required, one to solve for the <code>partials.value</code> fields and another to solve for the <code>partials.partials</code> fields. The source code for this implementation can be found <a href="https://github.com/Garren-H/IFTDuals.jl/blob/d92256a0b17b50ce34d4b540cd9e0823930b090f/src/derivatives.jl#L251">here</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../UserGuide/advanced/">« Advanced Usage</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 3 February 2026 15:27">Tuesday 3 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
